# LSTM

## 用于情感分类

### 第一次训练

数据量：

```
wc -l /var/www/data/sentiments/* 
18576 /var/www/data/sentiments/neg.txt
16548 /var/www/data/sentiments/pos.txt
1426 /var/www/data/sentiments/stopwords.txt
```

训练及预测效果：

```
单个样本最大长度：  1795
去重后的有效词的数量：  42606

Epoch 1/10
28099/28099 [==============================] - 1872s - loss: 0.3869 - acc: 0.8324 - val_loss: 0.2604 - val_acc: 0.8979
Epoch 2/10
28099/28099 [==============================] - 1792s - loss: 0.1949 - acc: 0.9283 - val_loss: 0.2627 - val_acc: 0.9153
Epoch 3/10
28099/28099 [==============================] - 1751s - loss: 0.1437 - acc: 0.9488 - val_loss: 0.2036 - val_acc: 0.9315
Epoch 4/10
28099/28099 [==============================] - 1724s - loss: 0.0898 - acc: 0.9685 - val_loss: 0.1994 - val_acc: 0.9372
Epoch 5/10
28099/28099 [==============================] - 1726s - loss: 0.0631 - acc: 0.9780 - val_loss: 0.2104 - val_acc: 0.9426
Epoch 6/10
28099/28099 [==============================] - 1727s - loss: 0.0507 - acc: 0.9822 - val_loss: 0.2258 - val_acc: 0.9422
Epoch 7/10
28099/28099 [==============================] - 1729s - loss: 0.0426 - acc: 0.9849 - val_loss: 0.2216 - val_acc: 0.9441
Epoch 8/10
28099/28099 [==============================] - 1724s - loss: 0.0419 - acc: 0.9848 - val_loss: 0.2558 - val_acc: 0.9443
Epoch 9/10
28099/28099 [==============================] - 1726s - loss: 0.0278 - acc: 0.9890 - val_loss: 0.2829 - val_acc: 0.9469
Epoch 10/10
28099/28099 [==============================] - 1727s - loss: 0.0247 - acc: 0.9908 - val_loss: 0.2645 - val_acc: 0.9498
7025/7025 [==============================] - 125s     

Test score: 0.265, accuracy: 0.950
```

在训练集上准确率达到99%，在测试集上准确率达到95%，比普通的方法确实好了许多。

### 第二次训练：分词之后增加黑名单过滤

```
单个样本最大长度：  893
去重后的有效词的数量：  42606
```



